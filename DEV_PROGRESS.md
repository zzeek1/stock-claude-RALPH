# 开发进度跟踪

> 本文档用于跟踪股票交易复盘系统的开发进度，每次开发任务开始和完成时更新。

---

## 当前进度

**当前版本**: v1.0  
**下一版本**: v1.1  
**当前任务**: 无  
**最后更新**: 2026-02-18

---

## 版本历史

| 版本 | 发布日期 | 主要功能 | 状态 |
|------|----------|----------|------|
| v1.0 | 2026-02-18 | 核心功能完成 | ✅ 已发布 |
| v1.1 | 待定 | 快捷键、数据导入、提醒功能 | 🚧 开发中 |
| v1.2 | 待定 | 交易日记、策略追踪、AI增强 | 📋 计划中 |
| v2.0 | 待定 | 多账户、K线图、云同步 | 📋 计划中 |

---

## P0 任务清单（必须完成）

### TASK-001: 快捷键支持
| 属性 | 值 |
|------|-----|
| 优先级 | P0 |
| 预计工时 | 4h |
| 状态 | 待开始 |
| 负责人 | - |
| 开始时间 | - |
| 完成时间 | - |

**功能描述**：
- 全局快捷键：`Ctrl+N` 打开新建交易页面
- 表单快捷键：`Ctrl+S` 保存、`Ctrl+E` 编辑、`Esc` 关闭弹窗
- 列表快捷键：`Delete` 删除选中项

**技术方案**：
```typescript
// src/main/index.ts - 注册全局快捷键
import { globalShortcut } from 'electron';

app.whenReady().then(() => {
  globalShortcut.register('CommandOrControl+N', () => {
    mainWindow.webContents.send('shortcut:newTrade');
  });
});

// src/renderer - 监听快捷键
useEffect(() => {
  window.electronAPI.onShortcut('newTrade', () => {
    navigate('/new-trade');
  });
}, []);
```

**验收标准**：
- [ ] `Ctrl+N` 可打开新建交易页面
- [ ] `Ctrl+S` 可保存当前表单
- [ ] `Esc` 可关闭弹窗
- [ ] 快捷键可在设置中查看和自定义

---

### TASK-002: 历史数据导入
| 属性 | 值 |
|------|-----|
| 优先级 | P0 |
| 预计工时 | 8h |
| 状态 | 待开始 |
| 负责人 | - |
| 开始时间 | - |
| 完成时间 | - |

**功能描述**：
- 支持导入 CSV/Excel 格式的历史交易数据
- 自动识别常见券商导出格式
- 提供字段映射配置界面
- 数据预览和校验

**技术方案**：
```
新增文件：
- src/main/services/import-service.ts   # 导入逻辑
- src/main/ipc/import-handlers.ts       # IPC 处理
- src/renderer/pages/DataImport.tsx     # 导入页面
- src/renderer/components/ImportWizard/ # 导入向导组件

数据库：
- 新增 import_logs 表记录导入历史
```

**实现步骤**：
1. [ ] 设计导入数据格式和映射规则
2. [ ] 实现 CSV/Excel 解析
3. [ ] 实现字段自动识别
4. [ ] 实现数据校验逻辑
5. [ ] 创建导入向导 UI
6. [ ] 实现导入进度显示
7. [ ] 添加导入历史记录

**验收标准**：
- [ ] 可导入 CSV 格式文件
- [ ] 可导入 Excel 格式文件
- [ ] 自动识别同花顺/东方财富格式
- [ ] 显示数据预览
- [ ] 提示数据错误
- [ ] 显示导入结果统计

---

## P1 任务清单（重要功能）

### TASK-003: 每日简报
| 属性 | 值 |
|------|-----|
| 优先级 | P1 |
| 预计工时 | 6h |
| 状态 | 待开始 |
| 依赖 | - |

**功能描述**：
- 每日首次打开应用时自动生成当日简报
- 显示：昨日交易摘要、当前持仓概况、今日待办
- 可手动刷新生成

**实现步骤**：
1. [ ] 设计简报数据结构
2. [ ] 实现简报生成逻辑
3. [ ] 创建简报展示组件
4. [ ] 添加自动触发机制

---

### TASK-004: 自动数据填充
| 属性 | 值 |
|------|-----|
| 优先级 | P1 |
| 预计工时 | 6h |
| 状态 | 待开始 |
| 依赖 | - |

**功能描述**：
- 选择股票后自动填入市场信息
- 卖出时自动关联买入记录
- 计算并显示预期盈亏

**实现步骤**：
1. [ ] 优化股票选择组件
2. [ ] 实现买入记录关联逻辑
3. [ ] 添加盈亏预计算显示

---

### TASK-005: 止损止盈提醒
| 属性 | 值 |
|------|-----|
| 优先级 | P1 |
| 预计工时 | 8h |
| 状态 | 待开始 |
| 依赖 | 实时行情API |

**功能描述**：
- 根据设置的止损/止盈价监控持仓
- 价格触及预警线时发送通知
- 支持设置预警阈值（如距离止损价5%）

**实现步骤**：
1. [ ] 设计预警规则数据结构
2. [ ] 实现价格监控服务
3. [ ] 集成系统通知
4. [ ] 创建预警设置界面

---

### TASK-006: 连续亏损提醒
| 属性 | 值 |
|------|-----|
| 优先级 | P1 |
| 预计工时 | 4h |
| 状态 | 待开始 |

**功能描述**：
- 检测连续亏损笔数
- 达到阈值时弹出提醒
- 建议暂停交易

---

### TASK-007: 自动备份
| 属性 | 值 |
|------|-----|
| 优先级 | P1 |
| 预计工时 | 4h |
| 状态 | 待开始 |

**功能描述**：
- 支持每日/每周自动备份
- 保留最近 N 个备份文件
- 可配置备份路径

---

### TASK-008: 资产曲线图
| 属性 | 值 |
|------|-----|
| 优先级 | P1 |
| 预计工时 | 4h |
| 状态 | 待开始 |

**功能描述**：
- 基于账户快照绘制资产曲线
- 在 Dashboard 和 Statistics 页面展示

---

### TASK-009: 交易计划跟踪
| 属性 | 值 |
|------|-----|
| 优先级 | P1 |
| 预计工时 | 8h |
| 状态 | 待开始 |

**功能描述**：
- 卖出时自动检查是否按止损/止盈计划执行
- 统计计划执行率
- AI 复盘时分析计划执行情况

---

### TASK-010: 风险评估报告
| 属性 | 值 |
|------|-----|
| 优先级 | P1 |
| 预计工时 | 6h |
| 状态 | 待开始 |

**功能描述**：
- 计算持仓集中度
- 计算风险敞口
- 提供风险预警

---

### TASK-011: 交易目标管理
| 属性 | 值 |
|------|-----|
| 优先级 | P1 |
| 预计工时 | 6h |
| 状态 | 待开始 |

**功能描述**：
- 设置月度/年度收益目标
- 显示目标进度
- 偏离目标时提醒

---

## P2 任务清单（增强功能）

### TASK-012: 交易日记
| 属性 | 值 |
|------|-----|
| 优先级 | P2 |
| 预计工时 | 8h |
| 状态 | 待开始 |

**功能描述**：
- 每日日记记录
- 与当天交易关联
- AI 复盘时参考日记

**实现步骤**：
1. [ ] 新增 diaries 表
2. [ ] 实现日记 CRUD
3. [ ] 创建日记页面
4. [ ] 集成到 AI 复盘

---

### TASK-013: 策略效果追踪
| 属性 | 值 |
|------|-----|
| 优先级 | P2 |
| 预计工时 | 6h |
| 状态 | 待开始 |

**功能描述**：
- 策略收益趋势图
- 策略胜率变化
- 策略失效预警

---

### TASK-014: 情绪热力图优化
| 属性 | 值 |
|------|-----|
| 优先级 | P2 |
| 预计工时 | 4h |
| 状态 | 待开始 |

**功能描述**：
- 改为真正的热力图形式
- X轴：交易前情绪，Y轴：交易后情绪
- 颜色：胜率/平均盈亏

---

### TASK-015: AI 多轮对话
| 属性 | 值 |
|------|-----|
| 优先级 | P2 |
| 预计工时 | 6h |
| 状态 | 待开始 |

**功能描述**：
- 支持与 AI 进行多轮对话
- 追问交易细节
- 保存对话历史

---

### TASK-016: 云备份
| 属性 | 值 |
|------|-----|
| 优先级 | P2 |
| 预计工时 | 8h |
| 状态 | 待开始 |

**功能描述**：
- 可选同步到云端
- 端到端加密
- 多设备同步

---

## P3 任务清单（锦上添花）

### TASK-017: 多账户管理
| 属性 | 值 |
|------|-----|
| 优先级 | P3 |
| 预计工时 | 12h |
| 状态 | 待开始 |

---

### TASK-018: K线图表集成
| 属性 | 值 |
|------|-----|
| 优先级 | P3 |
| 预计工时 | 16h |
| 状态 | 待开始 |

---

### TASK-019: PDF 报告导出
| 属性 | 值 |
|------|-----|
| 优先级 | P3 |
| 预计工时 | 6h |
| 状态 | 待开始 |

---

### TASK-020: 本地 AI 模型
| 属性 | 值 |
|------|-----|
| 优先级 | P3 |
| 预计工时 | 12h |
| 状态 | 待开始 |

---

## 进度更新日志

### 2026-02-21
- 实现 IBKR (Interactive Brokers) 交易数据 CSV 导入支持
- 优化导入服务，支持自动识别 IBKR 格式
- 修复 IBKR CSV 头部解析问题（重复列名处理）
- 增加 HK 股票代码自动补全逻辑

### 2026-02-18
- 完成 PRD 文档编写
- 完成开发进度跟踪体系搭建
- 整理待开发功能清单

---

## 开发规范

### 提交信息格式
```
<type>(<scope>): <subject>

type: feat|fix|docs|style|refactor|test|chore
scope: trade|stats|ai|settings|import|backup
subject: 简短描述

示例:
feat(trade): 添加快捷键支持
fix(stats): 修复收益曲线计算错误
```

### 分支命名
```
feature/TASK-XXX-功能名称
bugfix/问题描述
hotfix/紧急修复描述
```

### 代码审查要点
- [ ] 代码符合 TypeScript 规范
- [ ] 有适当的错误处理
- [ ] 关键逻辑有注释
- [ ] 新增功能有测试覆盖
- [ ] 不影响现有功能
